var _createClass=function(){function o(o,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}return function(t,a,r){return a&&o(t.prototype,a),r&&o(t,r),t}}();function _classCallCheck(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}var Bookmark=function(){function o(){_classCallCheck(this,o),this.lightcardBookmarkButton=$(".lightCard-bookmark"),this.courseBookmarkButton=$(".bookmark-button"),this.careerCourseBookmarkButton=$(".career-courses__bookmark"),this.learningGuideBookmarkButton=$(".btn-seguir"),this.studyPlanB2BBookmarkButton=$(".study-plan__follow-button"),this.bookmarkCounter=$(".bookmark-counter"),this.bookmarkCounterValue=this.bookmarkCounter?parseInt(this.bookmarkCounter.html()):0,this.ajaxLoading=!1}return _createClass(o,[{key:"lightcardBookmarkClick",value:function(o){var t=this,a=$(o.currentTarget),r=a.attr("data-course-code");this.post(o,r,function(){a.find(".lightCard-bookmark-checked-icon, .lightCard-bookmark-unchecked-icon").toggle(),t.ajaxLoading=!1})}},{key:"courseBookmarkClick",value:function(o){var t=this,a=$(o.currentTarget),r=a.data("course-code");this.post(o,r,function(){"true"==a.attr("data-bookmarked")?(a.html(a.attr("data-bookmark-display")),a.attr("data-bookmarked",!1),a.removeClass("bookmark-button--bookmarked")):(a.html(a.attr("data-unbookmark-display")),a.attr("data-bookmarked",!0),a.addClass("bookmark-button--bookmarked")),t.ajaxLoading=!1})}},{key:"careerCourseBookmarkClick",value:function(o){var t=this,a=$(o.target),r=a.attr("data-course-code");o.preventDefault(),o.stopPropagation(),this.post(o,r,function(){a.toggleClass("career-courses__bookmark--bookmarked"),t.ajaxLoading=!1},!0)}},{key:"studyPlanB2BClick",value:function(o){var t=$(o.target),a=t.attr("data-guide-code"),r="true"===t.attr("data-bookmarked");this.requestB2B(a,function(){t.toggleClass("study-plan__follow-button--following"),t.attr("data-bookmarked",!r),this.ajaxLoading=!1}.bind(this),r)}},{key:"updateCounter",value:function(o){this.bookmarkCounter&&(o?(this.bookmarkCounterValue-=1,this.bookmarkCounter.text(this.bookmarkCounterValue)):(this.bookmarkCounterValue+=1,this.bookmarkCounter.text(this.bookmarkCounterValue)))}},{key:"learningGuideBookmarkClick",value:function(o){var t=this;o.preventDefault(),o.stopPropagation();var a=$(o.currentTarget.parentNode),r=a.attr("data-guide-id"),e="true"==a.attr("data-is-bookmarked").toLowerCase(),n=e?a.css("color"):"rgba(0, 0, 0, 0.3)",i=e?"Seguir":"Seguindo",k="/learningGuide/"+r+"/"+(e?"unbookmark":"bookmark");this.learningGuideBookmarkPost(o,k,function(){t.updateCounter(e);var o=a.find(".btn-seguir-slider");a.find(">:first-child").text(i),o.css("background-color",n),o.toggleClass("btn-seguir-slider--checked"),a.attr("data-is-bookmarked",!e),t.ajaxLoading=!1},!0)}},{key:"post",value:function(o,t,a){if(!this.ajaxLoading){this.ajaxLoading=!0;var r={courseCode:t};$.post("/courses/toggle-bookmark",r).success(function(){a()}).fail(function(){window.alert("Ocorreu um erro!")})}}},{key:"requestB2B",value:function(o,t,a){if(!this.ajaxLoading){this.ajaxLoading=!0;var r=a?"learningGuide/"+o+"/unbookmark":"learningGuide/"+o+"/bookmark";$.post(r,t)}}},{key:"learningGuideBookmarkPost",value:function(o,t,a){this.ajaxLoading||(this.ajaxLoading=!0,$.post(t).success(function(){a()}).fail(function(){window.alert("Ocorreu um erro! Por favor, tente novamente.")}))}},{key:"refreshListener",value:function(){this.lightcardBookmarkButton.on("click",this.lightcardBookmarkClick.bind(this)),this.courseBookmarkButton.on("click",this.courseBookmarkClick.bind(this)),this.careerCourseBookmarkButton.on("click",this.careerCourseBookmarkClick.bind(this)),this.learningGuideBookmarkButton.on("click",this.learningGuideBookmarkClick.bind(this)),this.studyPlanB2BBookmarkButton.on("click",this.studyPlanB2BClick.bind(this))}}]),o}();